<style>
    .tooltip {
        z-index: 1000;
        position: relative;
        border: none;
    }
    .tooltip:before,
    .tooltip:after {
        display: block;
        opacity: 0;
        pointer-events: none;
        position: absolute;
    }
    .tooltip:after {
        border-right: 6px solid transparent;
        border-bottom: 6px solid rgba(0,0,0,.75); 
        border-left: 6px solid transparent;
        content: '';
        height: 0;
        top: 20px;
        left: 20px;
        width: 0;
    }
    .tooltip:before {
        background: rgba(0,0,0,.75);
        border-radius: 2px;
        color: #fff;
        content: attr(data-title);
        font-size: 1.4rem;
        padding: 6px 10px;
        top: 26px;
        white-space: normal;
    }

    /* the animations */
    /* fade */
    .tooltip.fade:after,
    .tooltip.fade:before {
        transform: translate3d(0,-10px,0);
        transition: all .15s ease-in-out;
    }
    .tooltip.fade:hover:after,
    .tooltip.fade:hover:before {
        opacity: 1;
        transform: translate3d(0,0,0);
    }

    /* expand */
    .tooltip.expand:before {
        transform: scale3d(.2,.2,1);
        transition: all .2s ease-in-out;
    }
    .tooltip.expand:after {
        transform: translate3d(0,6px,0);
        transition: all .1s ease-in-out;
    }
    .tooltip.expand:hover:before,
    .tooltip.expand:hover:after {
        opacity: 1;
        transform: scale3d(1,1,1);
    }
    .tooltip.expand:hover:after {
        transition: all .2s .1s ease-in-out;
    }

    /* swing */
    .tooltip.swing:before,
    .tooltip.swing:after {
        transform: translate3d(0,30px,0) rotate3d(0,0,1,60deg);
        transform-origin: 0 0;
        transition: transform .15s ease-in-out, opacity .2s;
    }
    .tooltip.swing:after {
        transform: translate3d(0,60px,0);
        transition: transform .15s ease-in-out, opacity .2s;
    }
    .tooltip.swing:hover:before,
    .tooltip.swing:hover:after {
        opacity: 1;
        transform: translate3d(0,0,0) rotate3d(1,1,1,0deg);
    }

    #all {
        width: 100%;
        align: center;
        font-size: 0px;
        align: center;
        overflow: hidden;
    }

    #query {
        border: none;
    }
</style>
<head>
    <title>Profile Graph</title>
    <style type="text/css">
        body {
            font: 16pt arial;
        }

        #viz {
            z-index: 1;
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body scroll="no" id="all" onload="draw()" ondblclick="followUrl()">
    <div id="viz"></div>
    <div id="main">
        <div class="search-container">
            <span style="search"><input id="search" style="border: 2px solid white; position: relative; float: left;" type="text" placeholder="Search for anything..." name="search">
                <button id="query" style="cursor:pointer;" onclick="search()"><i class="fa fa-search"></i></button>
            </span>
            <br/>
            <div id="helptext" >
                <span>
                    Find an attribute (ex. "project", "C++", "tool")
                    <br/>
                    Double-click nodes with links to view
                </span>
            </div>
        </div>
    </div>
</body>    
<script src="https://rawgit.com/neo4j-contrib/neovis.js/master/dist/neovis.js"></script>
<script type="text/javascript">

    var viz;

    function draw() {
        var config = {
            container_id: "viz",
            server_url: "bolt://www.1qaz2wsx3edc.xyz:7687",
            server_user: "neo4j",
            server_password: "test",
            encrypted: "ENCRYPTION_ON",
            trust: "TRUST_ALL_CERTIFICATES",
            labels: {
                "project": {
                    "caption": "name"
                },
                "framework": {
                    "caption": "name"
                },
                "language": {
                    "caption": "name"
                },
                "tool": {
                    "caption": "name"
                },
                "library": {
                    "caption": "name"
                },
                "About me": {
                    "caption": "name"
                },
                "database": {
                    "caption": "name"
                },
                "company": {
                    "caption": "name"
                },
                "ctf": {
                    "caption": "name"
                },
                "infrastructure": {
                    "caption": "name"
                },
            },
            relationships: {
                "USES": {
                    "caption": false
                },
                "KNOWS": {
                    "caption": false
                },
                "WRITTEN IN": {
                    "caption": false
                },
                "USING": {
                    "caption": false
                },
                "CREATED": {
                    "caption": false
                },
                "MADE AT": {
                    "caption": false
                },
                "WORKED AT": {
                    "caption": false
                },
                "PARTICIPANT": {
                    "caption": false
                },
            },
            initial_cypher: "MATCH (n)-[r]->(m) where not n:Graphileon return *"
            //initial_cypher: "match (n:project)-[r]->(m), (mm)-[rr]->(nn:project) return *"
        };

        viz = new NeoVis.default(config);
        viz.render();
    }

    function search() {
        var search = document.getElementById("search").value;
        search = search.split("").map(c => "[" + c + "]").join("");
        viz.renderWithCypher("match (n) with n, [x in keys(n) WHERE n[x]=~ '(?i).*" + search + ".*'] as doesMatch where size(doesMatch) > 0 match (n)-[r]-(m), (a:`About me`)-[r2]-() where not n:Graphileon return *");
    }

    function followUrl() {
        var nodeUrl = document.getElementsByClassName("vis-tooltip")[0];
        var nodeUrl = nodeUrl.innerHTML.match(/http.*?(?=<)/g)[0];
        window.open(nodeUrl);
    }

    // event listeners
    var input = document.getElementById("search");
    input.addEventListener("keyup", function(event) {
        // Number 13 is the "Enter" key on the keyboard
        if (event.keyCode === 13) {
            // Cancel the default action, if needed
            event.preventDefault();
            // Trigger the button element with a click
            document.getElementById("query").click();
        }
    });
    </script>
